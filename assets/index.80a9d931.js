var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,l,n)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,s=(e,t)=>{for(var l in t||(t={}))o.call(t,l)&&r(e,l,t[l]);if(n)for(var l of n(t))a.call(t,l)&&r(e,l,t[l]);return e},i=(e,n)=>t(e,l(n)),c=(e,t,l)=>new Promise(((n,o)=>{var a=e=>{try{s(l.next(e))}catch(t){o(t)}},r=e=>{try{s(l.throw(e))}catch(t){o(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,r);s((l=l.apply(e,t)).next())}));import{e as u,q as d,as as p,aI as f,x as g,w as h,S as m,c as b,aq as y,v,aD as C,aE as H,aC as M,ab as F}from"./index.c1a25957.js";import{aj as S,u as k,A as O,V as B,x as P,w,bQ as x,r as T,bU as j,j as W,R as $,Y as N,af as R,Z as E,_,av as A,L as V,F as I,a3 as L,G as D,a5 as q,a6 as z,b3 as Y,b4 as X,bu as G,a8 as J,a9 as Q,a1 as U,aa as Z,J as K,ak as ee,o as te,ae as le,aB as ne,ap as oe,O as ae,t as re,bw as se}from"./vendor.517bedfb.js";import{u as ie}from"./useWindowSizeFn.45b2e0d5.js";const{t:ce}=u(),ue={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:ce("common.cancelText")},okText:{type:String,default:ce("common.okText")},closeFunc:Function},de=Object.assign({},ue,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function pe(e){const t=(e,t)=>getComputedStyle(e)[t],l=l=>{if(!l)return;l.setAttribute("data-drag",k(e.draggable));const n=l.querySelector(".ant-modal-header"),o=l.querySelector(".ant-modal");n&&o&&k(e.draggable)&&(n.style.cursor="move",n.onmousedown=e=>{if(!e)return;const l=e.clientX,n=e.clientY,a=document.body.clientWidth,r=document.documentElement.clientHeight,s=o.offsetWidth,i=o.offsetHeight,c=o.offsetLeft,u=a-o.offsetLeft-s,d=o.offsetTop,p=r-o.offsetTop-i,f=t(o,"left"),g=t(o,"top");let h=+f,m=+g;f.includes("%")?(h=+document.body.clientWidth*(+f.replace(/%/g,"")/100),m=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(h=+f.replace(/px/g,""),m=+g.replace(/px/g,"")),document.onmousemove=function(e){let t=e.clientX-l,a=e.clientY-n;-t>c?t=-c:t>u&&(t=u),-a>d?a=-d:a>p&&(a=p),o.style.cssText+=`;left:${t+h}px;top:${a+m}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};S((()=>{k(e.visible)&&k(e.draggable)&&d((()=>{(()=>{const n=document.querySelectorAll(".ant-modal-wrap");for(const o of Array.from(n)){if(!o)continue;const n=t(o,"display"),a=o.getAttribute("data-drag");"none"!==n&&(null===a||k(e.destroyOnClose))&&l(o)}})()}),30)}))}var fe=O({name:"Modal",inheritAttrs:!1,props:de,setup(e,{slots:t}){const{visible:l,draggable:n,destroyOnClose:o}=B(e),a=p();return pe({visible:l,destroyOnClose:o,draggable:n}),()=>{let l;const n=s(s({},k(a)),e);return P(w,n,"function"==typeof(o=l=f(t))||"[object Object]"===Object.prototype.toString.call(o)&&!x(o)?l:{default:()=>[l]});var o}}});const ge=Symbol();function he(){return g(ge)}var me=O({name:"ModalWrapper",components:{ScrollContainer:m},inheritAttrs:!1,props:{loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},emits:["height-change","ext-height"],setup(e,{emit:t}){const l=T(null),n=T(null),o=T(0),a=T(0);let r=0;ie(i.bind(null,!1)),j(n,(()=>{i()}),{attributes:!0,subtree:!0}),h({redoModalHeight:i},ge);const s=W((()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${k(o)}px`})));function i(){return c(this,null,(function*(){if(!e.visible)return;const a=k(l);if(!a)return;const s=a.$el.parentElement;if(s){s.style.padding="0",yield E();try{const l=s.parentElement&&s.parentElement.parentElement;if(!l)return;const a=getComputedStyle(l).top,i=Number.parseInt(a);let c=window.innerHeight-2*i+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;i<40&&(c-=26),yield E();const u=k(n);if(!u)return;yield E(),r=u.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:r>c?c:r,t("height-change",k(o))}catch(i){}}}))}return S((()=>{e.useWrapper&&i()})),$((()=>e.fullScreen),(e=>{i(),e?a.value=o.value:o.value=a.value})),N((()=>{const{modalHeaderHeight:l,modalFooterHeight:n}=e;t("ext-height",l+n)})),R((()=>{})),{wrapperRef:l,spinRef:n,spinStyle:s,scrollTop:function(){return c(this,null,(function*(){E((()=>{var e;const t=k(l);t&&(null==(e=null==t?void 0:t.scrollTo)||e.call(t,0))}))}))},setModalHeight:i}}});me.render=function(e,t,l,n,o,a){const r=_("ScrollContainer"),s=A("loading");return V(),I(r,{ref:"wrapperRef"},{default:L((()=>[D(P("div",{ref:"spinRef",style:e.spinStyle,"loading-tip":e.loadingTip},[q(e.$slots,"default")],12,["loading-tip"]),[[s,e.loading]])])),_:3},512)};var be=O({name:"ModalClose",components:{Tooltip:z,FullscreenExitOutlined:Y,FullscreenOutlined:X,CloseOutlined:G},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:t}){const{prefixCls:l}=b("basic-modal-close"),{t:n}=u();return{t:n,getClass:W((()=>[l,`${l}--custom`,{[`${l}--can-full`]:e.canFullscreen}])),prefixCls:l,handleCancel:function(e){t("cancel",e)},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),t("fullscreen")}}}});be.render=function(e,t,l,n,o,a){const r=_("FullscreenExitOutlined"),s=_("Tooltip"),i=_("FullscreenOutlined"),c=_("CloseOutlined");return V(),I("div",{class:e.getClass},[e.canFullscreen?(V(),I(J,{key:0},[e.fullScreen?(V(),I(s,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:L((()=>[P(r,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])])),_:1},8,["title"])):(V(),I(s,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:L((()=>[P(i,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])])),_:1},8,["title"]))],2112)):Q("v-if",!0),P(s,{title:e.t("component.modal.close"),placement:"bottom"},{default:L((()=>[P(c,{onClick:e.handleCancel},null,8,["onClick"])])),_:1},8,["title"])],2)};var ye=O({name:"BasicModalFooter",props:de,emits:["ok","cancel"],setup:(e,{emit:t})=>({handleOk:function(e){t("ok",e)},handleCancel:function(e){t("cancel",e)}})});ye.render=function(e,t,l,n,o,a){const r=_("a-button");return V(),I("div",null,[q(e.$slots,"insertFooter"),e.showCancelBtn?(V(),I(r,U({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:L((()=>[Z(K(e.cancelText),1)])),_:1},16,["onClick"])):Q("v-if",!0),q(e.$slots,"centerFooter"),e.showOkBtn?(V(),I(r,U({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:L((()=>[Z(K(e.okText),1)])),_:1},16,["type","onClick","loading"])):Q("v-if",!0),q(e.$slots,"appendFooter")])};var ve=O({name:"BasicModalHeader",components:{BasicTitle:y},props:{helpMessage:{type:[String,Array]},title:{type:String}}});ve.render=function(e,t,l,n,o,a){const r=_("BasicTitle");return V(),I(r,{helpMessage:e.helpMessage},{default:L((()=>[Z(K(e.title),1)])),_:1},8,["helpMessage"])};var Ce=O({name:"BasicModal",components:{Modal:fe,ModalWrapper:me,ModalClose:be,ModalFooter:ye,ModalHeader:ve},inheritAttrs:!1,props:de,emits:["visible-change","height-change","cancel","ok","register","update:visible"],setup(e,{emit:t,attrs:l}){const n=T(!1),o=T(null),a=T(null),r=T(0),u={setModalProps:function(e){o.value=C(k(o)||{},e),Reflect.has(e,"visible")&&(n.value=!!e.visible);Reflect.has(e,"defaultFullscreen")&&(h.value=!!e.defaultFullscreen)},emitVisible:void 0,redoModalHeight:()=>{E((()=>{k(a)&&k(a).setModalHeight()}))}},d=le();d&&t("register",u,d.uid);const p=W((()=>s(s({},e),k(o)))),{handleFullScreen:f,getWrapClassName:g,fullScreenRef:h}=function(e){const t=T(!1);return{getWrapClassName:W((()=>{const l=k(e.wrapClassName)||"";return k(t)?`fullscreen-modal ${l} `:k(l)})),handleFullScreen:function(e){e&&e.stopPropagation(),t.value=!k(t)},fullScreenRef:t}}({modalWrapperRef:a,extHeightRef:r,wrapClassName:ee(p.value,"wrapClassName")}),m=W((()=>{const e=i(s({},k(p)),{visible:k(n),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return i(s({},e),{wrapClassName:k(g)})})),b=W((()=>{const e=i(s(s({},l),k(p)),{visible:k(n),wrapClassName:k(g)});return k(h)?te(e,"height"):e})),y=W((()=>{if(!k(h))return k(m).height}));return S((()=>{n.value=!!e.visible,h.value=!!e.defaultFullscreen})),$((()=>k(n)),(l=>{var n;t("visible-change",l),t("update:visible",l),d&&(null==(n=u.emitVisible)||n.call(u,l,d.uid)),E((()=>{e.scrollTop&&l&&k(a)&&k(a).scrollTop()}))}),{immediate:!1}),{handleCancel:function(l){return c(this,null,(function*(){if(null==l||l.stopPropagation(),e.closeFunc&&v(e.closeFunc)){const t=yield e.closeFunc();n.value=!t}else n.value=!1,t("cancel",l)}))},getBindValue:b,getProps:m,handleFullScreen:f,fullScreenRef:h,getMergeProps:p,handleOk:function(e){t("ok",e)},visibleRef:n,omit:te,modalWrapperRef:a,handleExtHeight:function(e){r.value=e},handleHeightChange:function(e){t("height-change",e)},handleTitleDbClick:function(t){e.canFullscreen&&(t.stopPropagation(),f(t))},getWrapperHeight:y}}});Ce.render=function(e,t,l,n,o,a){const r=_("ModalClose"),s=_("ModalHeader"),i=_("ModalFooter"),c=_("ModalWrapper"),u=_("Modal");return V(),I(u,U(e.getBindValue,{onCancel:e.handleCancel}),ne({default:L((()=>[P(c,U({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:L((()=>[q(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:L((()=>[P(r,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]))},e.$slots.title?void 0:{name:"title",fn:L((()=>[P(s,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]))},e.$slots.footer?void 0:{name:"footer",fn:L((()=>[P(i,U(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),ne({_:2},[oe(Object.keys(e.$slots),(t=>({name:t,fn:L((l=>[q(e.$slots,t,l)]))})))]),1040,["onOk","onCancel"])]))},oe(Object.keys(e.omit(e.$slots,"default")),(t=>({name:t,fn:L((l=>[q(e.$slots,t,l)]))})))]),1040,["onCancel"])};const He=ae({}),Me=ae({});function Fe(){const e=T(null),t=T(!1),l=T("");const n=()=>{const t=k(e);return t||M("useModal instance is undefined!"),t};return[function(n,o){if(!le())throw new Error("useModal() can only be used inside setup() or functional components!");l.value=o,k(t)&&H()&&n===k(e)||(e.value=n,n.emitVisible=(e,t)=>{Me[t]=e})},{setModalProps:e=>{var t;null==(t=n())||t.setModalProps(e)},getVisible:W((()=>Me[~~k(l)])),redoModalHeight:()=>{var e,t;null==(t=null==(e=n())?void 0:e.redoModalHeight)||t.call(e)},openModal:(e=!0,t,o=!0)=>{var a;if(null==(a=n())||a.setModalProps({visible:e}),!t)return;const r=k(l);if(o)return He[r]=null,void(He[r]=re(t));se(re(He[r]),re(t))||(He[r]=re(t))},closeModal:()=>{var e;null==(e=n())||e.setModalProps({visible:!1})}}]}const Se=e=>{const t=T(null),l=le(),n=T(""),o=()=>{const e=k(t);return e||M("useModalInner instance is undefined!"),e};return S((()=>{const t=He[k(n)];t&&e&&v(e)&&E((()=>{e(t)}))})),[(e,o)=>{n.value=o,t.value=e,null==l||l.emit("register",e,o)},{changeLoading:(e=!0)=>{var t;null==(t=o())||t.setModalProps({loading:e})},getVisible:W((()=>Me[~~k(n)])),changeOkLoading:(e=!0)=>{var t;null==(t=o())||t.setModalProps({confirmLoading:e})},closeModal:()=>{var e;null==(e=o())||e.setModalProps({visible:!1})},setModalProps:e=>{var t;null==(t=o())||t.setModalProps(e)},redoModalHeight:()=>{var e;const t=null==(e=o())?void 0:e.redoModalHeight;t&&t()}}]},ke=F(Ce);export{ke as B,Se as a,Fe as b,he as u};
