var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,i=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&l(e,a,t[a]);if(r)for(var a of r(t))o.call(t,a)&&l(e,a,t[a]);return e},n=(e,r)=>t(e,a(r)),d=(e,t,a)=>new Promise(((r,s)=>{var o=e=>{try{i(a.next(e))}catch(t){s(t)}},l=e=>{try{i(a.throw(e))}catch(t){s(t)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,l);i((a=a.apply(e,t)).next())}));import{ag as c,bq as u,A as p,r as m,j as b,u as f,_ as g,L as y,F as v,a3 as h,x as D,a1 as w}from"./vendor.517bedfb.js";import{f as I}from"./BasicForm.dc1a8526.js";import{u as j}from"./useForm.d9f38e8c.js";/* empty css              */import{s as x}from"./directory.31b975a4.js";import{u as P,aG as S,i as O}from"./index.a6fa69dd.js";import{B as F,a as L}from"./index.af0d4e7b.js";import{_ as B}from"./Tree.vue_vue&type=style&index=0&lang.6368a1a6.js";const{devUrl:U}=P();var _,k;(k=_||(_={})).DirectoryPageList="/dic/findDic",k.GetAllDirectoryList="/system/getAllDirectoryList",k.AddDirectory="/dic/add",k.UpdateDirectory="/dic/update",k.DeleteDirectory="/dic/delete",k.MenuList="/system/getMenuList",k.setDirectoryStatus="/system/setRoleStatus";const R=e=>S.get({url:_.DirectoryPageList,params:n(i({},e),{parentId:"402881847b2c2d77017b2c2eb4c70003"})},{devUrl:U}),T=e=>S.post({url:_.DeleteDirectory,params:n(i({},e),{parentId:"402881847b2c2d77017b2c2eb4c70003"})},{devUrl:U}),A=[{title:"获客渠道名称",dataIndex:"label",width:200},{title:"获客渠道值",dataIndex:"code",width:180},{title:"排序",dataIndex:"orderNo",width:50},{title:"状态",dataIndex:"status",width:120,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),c(u,{checked:"0"===e.status,checkedChildren:"已启用",unCheckedChildren:"已禁用",loading:e.pendingStatus,onChange(t){e.pendingStatus=!0;const a=t?"0":"1",{createMessage:r}=O();x(e.id,a).then((()=>{e.status=a,r.success("已成功修改获客渠道状态")})).catch((()=>{r.error("修改获客渠道状态失败")})).finally((()=>{e.pendingStatus=!1}))}}))},{title:"创建时间",dataIndex:"createTime",width:180},{title:"备注",dataIndex:"remark"}],M=[{field:"label",label:"获客渠道名称",component:"Input",colProps:{span:8}},{field:"status",label:"状态",component:"Select",componentProps:{options:[{label:"启用",value:"0"},{label:"停用",value:"1"}]},colProps:{span:8}}],C=[{field:"label",label:"获客渠道名称",required:!0,component:"Input"},{field:"code",label:"获客渠道值",required:!0,component:"Input"},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"启用",value:"0"},{label:"停用",value:"1"}]}},{label:"备注",field:"remark",component:"InputTextArea"},{label:" ",field:"menu",slot:"menu",component:"Input"}];var G=p({name:"QudaoDrawer",components:{BasicDrawer:F,BasicForm:I,BasicTree:B},emits:["success","register"],setup(e,{emit:t}){const a=m(!0),r=m([]);let s="";const[o,{resetFields:l,setFieldsValue:c,validate:u}]=j({labelWidth:90,schemas:C,showActionButtonGroup:!1}),[p,{setDrawerProps:g,closeDrawer:y}]=L((e=>d(this,null,(function*(){var t;l(),g({confirmLoading:!1}),0===f(r).length&&(r.value=yield S.get({url:_.MenuList,params:t})),a.value=!!(null==e?void 0:e.isUpdate),f(a)&&(c(i({},e.record)),s=e.record.dicId)}))));return{registerDrawer:p,registerForm:o,getTitle:b((()=>f(a)?"编辑获客渠道":"新增获客渠道")),handleSubmit:function(){return d(this,null,(function*(){try{const r=yield u();g({confirmLoading:!0}),a.value?yield(e=n(i({},r),{dicId:s}),S.post({url:_.UpdateDirectory,params:n(i({},e),{parentId:"402881847b2c2d77017b2c2eb4c70003"})},{devUrl:U})):yield(e=>S.post({url:_.AddDirectory,params:n(i({},e),{parentId:"402881847b2c2d77017b2c2eb4c70003"})},{devUrl:U}))(r),y(),t("success")}finally{g({confirmLoading:!1})}var e}))},treeData:r}}});G.render=function(e,t,a,r,s,o){const l=g("BasicTree"),i=g("BasicForm"),n=g("BasicDrawer");return y(),v(n,w(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:h((()=>[D(i,{onRegister:e.registerForm},{menu:h((({model:t,field:a})=>[D(l,{value:t[a],"onUpdate:value":e=>t[a]=e,treeData:e.treeData,replaceFields:{title:"menuName",key:"id"},checkable:"",toolbar:"",title:"菜单分配"},null,8,["value","onUpdate:value","treeData"])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var q=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:G});export{q as Q,G as _,A as c,T as d,R as g,M as s};
