var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,n=(e,t,a)=>new Promise(((r,o)=>{var n=e=>{try{s(a.next(e))}catch(t){o(t)}},l=e=>{try{s(a.throw(e))}catch(t){o(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,l);s((a=a.apply(e,t)).next())}));import{ag as l,bA as s,A as i,r as d,j as u,u as c,_ as m,L as p,F as f,a3 as b,x as h,a1 as g}from"./vendor.8887d027.js";import{_ as v}from"./BasicForm.24833f51.js";import{u as w}from"./useForm.341a37c5.js";/* empty css              */import{s as y,d as x}from"./system.6ecb946a.js";import{i as j}from"./index.139ebaf4.js";import{B as I,a as D}from"./index.93fada4d.js";import{_ as F}from"./Tree.vue_vue&type=style&index=0&lang.d36b0fe9.js";const S=[{title:"角色名称",dataIndex:"roleName",width:200},{title:"角色值",dataIndex:"roleValue",width:180},{title:"排序",dataIndex:"orderNo",width:50},{title:"状态",dataIndex:"status",width:120,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),l(s,{checked:"1"===e.status,checkedChildren:"已启用",unCheckedChildren:"已禁用",loading:e.pendingStatus,onChange(t){e.pendingStatus=!0;const a=t?"1":"0",{createMessage:r}=j();y(e.id,a).then((()=>{e.status=a,r.success("已成功修改角色状态")})).catch((()=>{r.error("修改角色状态失败")})).finally((()=>{e.pendingStatus=!1}))}}))},{title:"创建时间",dataIndex:"createTime",width:180},{title:"备注",dataIndex:"remark"}],_=[{field:"roleNme",label:"角色名称",component:"Input",colProps:{span:8}},{field:"status",label:"状态",component:"Select",componentProps:{options:[{label:"启用",value:"0"},{label:"停用",value:"1"}]},colProps:{span:8}}],B=[{field:"roleName",label:"角色名称",required:!0,component:"Input"},{field:"roleValue",label:"角色值",required:!0,component:"Input"},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"启用",value:"0"},{label:"停用",value:"1"}]}},{label:"备注",field:"remark",component:"InputTextArea"},{label:" ",field:"menu",slot:"menu",component:"Input"}];var P=i({name:"RoleDrawer",components:{BasicDrawer:I,BasicForm:v,BasicTree:F},emits:["success","register"],setup(e,{emit:l}){const s=d(!0),i=d([]),[m,{resetFields:p,setFieldsValue:f,validate:b}]=w({labelWidth:90,schemas:B,showActionButtonGroup:!1}),[h,{setDrawerProps:g,closeDrawer:v}]=D((e=>n(this,null,(function*(){p(),g({confirmLoading:!1}),0===c(i).length&&(i.value=yield x()),s.value=!!(null==e?void 0:e.isUpdate),c(s)&&f(((e,n)=>{for(var l in n||(n={}))a.call(n,l)&&o(e,l,n[l]);if(t)for(var l of t(n))r.call(n,l)&&o(e,l,n[l]);return e})({},e.record))}))));return{registerDrawer:h,registerForm:m,getTitle:u((()=>c(s)?"编辑角色":"新增角色")),handleSubmit:function(){return n(this,null,(function*(){try{yield b();g({confirmLoading:!0}),v(),l("success")}finally{g({confirmLoading:!1})}}))},treeData:i}}});P.render=function(e,t,a,r,o,n){const l=m("BasicTree"),s=m("BasicForm"),i=m("BasicDrawer");return p(),f(i,g(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:b((()=>[h(s,{onRegister:e.registerForm},{menu:b((({model:t,field:a})=>[h(l,{value:t[a],"onUpdate:value":e=>t[a]=e,treeData:e.treeData,replaceFields:{title:"menuName",key:"id"},checkable:"",toolbar:"",title:"菜单分配"},null,8,["value","onUpdate:value","treeData"])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var k=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:P});export{k as R,P as _,S as c,_ as s};
