import{A as e,aX as a,aY as s,aP as o,aZ as r,al as t,r as l,O as n,j as i,t as c,u as d,_ as u,F as m,G as f,H as g,J as p,x as h,a3 as v,aa as y,K as x,a_ as w,a8 as F}from"./vendor.18836d94.js";/* empty css              *//* empty css              */import{c as L,f as C,e as S,h as D,i as _}from"./index.0dd8ec84.js";import{_ as I,u as b,a as j,b as k,L as P,c as T}from"./LoginFormTitle.ac8a0749.js";var R=e({name:"LoginForm",components:{[a.name]:a,[s.name]:s,Button:o,Form:r,FormItem:r.Item,Input:t,LoginFormTitle:I,InputPassword:t.Password},setup(){const{t:e}=S(),{notification:a,createErrorModal:s}=_(),{prefixCls:o}=L("login"),r=C(),{setLoginState:t,getLoginState:u}=b(),{getFormRules:m}=j(),f=l(),g=l(!1),p=l(!1),h=n({account:"admin",password:"admin",code:""}),{key:v,code:y,refresh:x}=k(),{validForm:w}=T(f),F=i((()=>d(u)===P.LOGIN));return{t:e,prefixCls:o,formRef:f,formData:h,getFormRules:m,rememberMe:p,handleLogin:function(){return t=this,l=null,n=function*(){const t=yield w();if(t)try{g.value=!0;const s=yield r.login(c({pwd:D(t.password),userName:t.account,code:t.code,codeKey:v.value,mode:"none"}));s&&a.success({message:e("sys.login.loginSuccessTitle"),description:`${e("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3})}catch(l){s({title:e("sys.api.errorTip"),content:l.message||e("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${o}`)||document.body}),x()}finally{g.value=!1}},new Promise(((e,a)=>{var s=e=>{try{r(n.next(e))}catch(s){a(s)}},o=e=>{try{r(n.throw(e))}catch(s){a(s)}},r=a=>a.done?e(a.value):Promise.resolve(a.value).then(s,o);r((n=n.apply(t,l)).next())}));var t,l,n},loading:g,setLoginState:t,LoginStateEnum:P,getShow:F,verCode:y,refreshVerCode:x}}});const z={class:"flex"},K={class:"flex-none w-1/4 bg-white cursor-pointer"};R.render=function(e,a,s,o,r,t){const l=u("LoginFormTitle"),n=u("Input"),i=u("FormItem"),c=u("InputPassword"),d=u("Button"),L=u("Form");return m(),f(F,null,[g(h(l,{class:"enter-x"},null,512),[[p,e.getShow]]),g(h(L,{class:"p-4 enter-x",model:e.formData,rules:e.getFormRules,ref:"formRef",onKeypress:w(e.handleLogin,["enter"])},{default:v((()=>[h(i,{name:"account",class:"enter-x"},{default:v((()=>[h(n,{size:"large",value:e.formData.account,"onUpdate:value":a[1]||(a[1]=a=>e.formData.account=a),placeholder:e.t("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])])),_:1}),h(i,{name:"password",class:"enter-x"},{default:v((()=>[h(c,{size:"large",visibilityToggle:"",value:e.formData.password,"onUpdate:value":a[2]||(a[2]=a=>e.formData.password=a),placeholder:e.t("sys.login.password")},null,8,["value","placeholder"])])),_:1}),h(i,{name:"code",class:"enter-x"},{default:v((()=>[h("div",z,[h(n,{class:["flex-1",`${e.prefixCls}-form-code-input`],size:"large",value:e.formData.code,"onUpdate:value":a[3]||(a[3]=a=>e.formData.code=a),placeholder:e.t("sys.login.code")},null,8,["class","value","placeholder"]),h("div",K,[h("img",{class:"w-full h-full",src:e.verCode,onClick:a[4]||(a[4]=(...a)=>e.refreshVerCode&&e.refreshVerCode(...a))},null,8,["src"])])])])),_:1}),h(i,{class:"enter-x"},{default:v((()=>[h(d,{type:"primary",size:"large",block:"",onClick:e.handleLogin,loading:e.loading},{default:v((()=>[y(x(e.t("sys.login.loginButton")),1)])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["model","rules","onKeypress"]),[[p,e.getShow]])],64)};export{R as default};
