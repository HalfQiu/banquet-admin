import{A as e,aV as a,aW as s,aN as o,aX as r,al as t,r as l,O as n,j as i,t as c,u as d,_ as u,L as m,F as f,G as g,H as p,x as h,aY as v,a3 as y,aa as x,J as w,a8 as L}from"./vendor.f90788d9.js";/* empty css              *//* empty css              */import{c as F,f as C,e as S,h as D,i as b}from"./index.27af0dce.js";import{_ as I,u as _,a as j,b as k,L as T,c as N}from"./LoginFormTitle.058b0166.js";var P=e({name:"LoginForm",components:{[a.name]:a,[s.name]:s,Button:o,Form:r,FormItem:r.Item,Input:t,LoginFormTitle:I,InputPassword:t.Password},setup(){const{t:e}=S(),{notification:a,createErrorModal:s}=b(),{prefixCls:o}=F("login"),r=C(),{setLoginState:t,getLoginState:u}=_(),{getFormRules:m}=j(),f=l(),g=l(!1),p=l(!1),h=n({account:"admin",password:"admin",code:""}),{key:v,code:y,refresh:x}=k(),{validForm:w}=N(f),L=i((()=>d(u)===T.LOGIN));return{t:e,prefixCls:o,formRef:f,formData:h,getFormRules:m,rememberMe:p,handleLogin:function(){return t=this,l=null,n=function*(){const t=yield w();if(t)try{g.value=!0;const s=yield r.login(c({pwd:D(t.password),userName:t.account,code:t.code,codeKey:v.value,mode:"none"}));s&&a.success({message:e("sys.login.loginSuccessTitle"),description:`${e("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3})}catch(l){s({title:e("sys.api.errorTip"),content:l.message||e("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${o}`)||document.body}),x()}finally{g.value=!1}},new Promise(((e,a)=>{var s=e=>{try{r(n.next(e))}catch(s){a(s)}},o=e=>{try{r(n.throw(e))}catch(s){a(s)}},r=a=>a.done?e(a.value):Promise.resolve(a.value).then(s,o);r((n=n.apply(t,l)).next())}));var t,l,n},loading:g,setLoginState:t,LoginStateEnum:T,getShow:L,verCode:y,refreshVerCode:x}}});const R={class:"flex"},z={class:"flex-none w-1/4 bg-white cursor-pointer"};P.render=function(e,a,s,o,r,t){const l=u("LoginFormTitle"),n=u("Input"),i=u("FormItem"),c=u("InputPassword"),d=u("Button"),F=u("Form");return m(),f(L,null,[g(h(l,{class:"enter-x"},null,512),[[p,e.getShow]]),g(h(F,{class:"p-4 enter-x",model:e.formData,rules:e.getFormRules,ref:"formRef",onKeypress:v(e.handleLogin,["enter"])},{default:y((()=>[h(i,{name:"account",class:"enter-x"},{default:y((()=>[h(n,{size:"large",value:e.formData.account,"onUpdate:value":a[1]||(a[1]=a=>e.formData.account=a),placeholder:e.t("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])])),_:1}),h(i,{name:"password",class:"enter-x"},{default:y((()=>[h(c,{size:"large",visibilityToggle:"",value:e.formData.password,"onUpdate:value":a[2]||(a[2]=a=>e.formData.password=a),placeholder:e.t("sys.login.password")},null,8,["value","placeholder"])])),_:1}),h(i,{name:"code",class:"enter-x"},{default:y((()=>[h("div",R,[h(n,{class:["flex-1",`${e.prefixCls}-form-code-input`],size:"large",value:e.formData.code,"onUpdate:value":a[3]||(a[3]=a=>e.formData.code=a),placeholder:e.t("sys.login.code")},null,8,["class","value","placeholder"]),h("div",z,[h("img",{class:"w-full h-full",src:e.verCode,onClick:a[4]||(a[4]=(...a)=>e.refreshVerCode&&e.refreshVerCode(...a))},null,8,["src"])])])])),_:1}),h(i,{class:"enter-x"},{default:y((()=>[h(d,{type:"primary",size:"large",block:"",onClick:e.handleLogin,loading:e.loading},{default:y((()=>[x(w(e.t("sys.login.loginButton")),1)])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["model","rules","onKeypress"]),[[p,e.getShow]])],64)};export{P as default};
