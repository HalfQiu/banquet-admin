var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,n=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&i(e,a,t[a]);if(r)for(var a of r(t))l.call(t,a)&&i(e,a,t[a]);return e},s=(e,t,a)=>new Promise(((r,o)=>{var l=e=>{try{n(a.next(e))}catch(t){o(t)}},i=e=>{try{n(a.throw(e))}catch(t){o(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,i);n((a=a.apply(e,t)).next())}));import{A as d,r as c,j as p,u as m,_ as u,L as f,F as b,a3 as g,x as h,a1 as v}from"./vendor.517bedfb.js";import{B as y,a as w}from"./index.80a9d931.js";import{f as I}from"./BasicForm.d5d93021.js";import{u as P}from"./useForm.3c867098.js";import{i as j,b as O,a as x}from"./system.7fd39e9e.js";const F=[{title:"用户名",dataIndex:"userName",width:120},{title:"昵称",dataIndex:"realName",width:120},{title:"邮箱",dataIndex:"email",width:120},{title:"创建时间",dataIndex:"createTime",width:180},{title:"角色",dataIndex:"role",width:200},{title:"备注",dataIndex:"remark"}],M=[{field:"userName",label:"用户名",component:"Input",colProps:{span:8}},{field:"realName",label:"昵称",component:"Input",colProps:{span:8}}],S=[{field:"userName",label:"用户名",component:"Input",helpMessage:["本字段演示异步验证","不能输入带有admin的用户名"],rules:[{required:!0,message:"请输入用户名"},{validator:(e,t)=>new Promise(((e,a)=>{j(t).then((()=>e())).catch((e=>{a(e.message||"验证失败")}))}))}]},{field:"pwd",label:"密码",component:"InputPassword",required:!0,ifShow:!1},{label:"角色",field:"role",component:"ApiSelect",componentProps:{api:O,labelField:"roleName",valueField:"value"},required:!0},{field:"dept",label:"所属部门",component:"TreeSelect",componentProps:{replaceFields:{title:"deptName",key:"deptId",value:"deptId"},getPopupContainer:()=>document.body},required:!0},{field:"realName",label:"昵称",component:"Input",required:!0},{label:"邮箱",field:"email",component:"Input",required:!0},{label:"备注",field:"remark",component:"InputTextArea"}];var N=d({name:"AccountModal",components:{BasicModal:y,BasicForm:I},emits:["success","register"],setup(e,{emit:r}){const o=c(!0),l=c(""),[i,{setFieldsValue:d,updateSchema:u,resetFields:f,validate:b}]=P({labelWidth:100,schemas:S,showActionButtonGroup:!1,actionColOptions:{span:23}}),[g,{setModalProps:h,closeModal:v}]=w((e=>s(this,null,(function*(){f(),h({confirmLoading:!1}),o.value=!!(null==e?void 0:e.isUpdate),m(o)&&(l.value=e.record.id,d(n({},e.record)));const t=yield x();u([{field:"pwd",show:!m(o)},{field:"dept",componentProps:{treeData:t}}])}))));return{registerModal:g,registerForm:i,getTitle:p((()=>m(o)?"编辑账号":"新增账号")),handleSubmit:function(){return s(this,null,(function*(){try{const s=yield b();h({confirmLoading:!0}),v(),r("success",{isUpdate:m(o),values:(e=n({},s),i={id:l.value},t(e,a(i)))})}finally{h({confirmLoading:!1})}var e,i}))}}}});N.render=function(e,t,a,r,o,l){const i=u("BasicForm"),n=u("BasicModal");return f(),b(n,v(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:g((()=>[h(i,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var B=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:N});export{B as A,N as _,F as c,M as s};
