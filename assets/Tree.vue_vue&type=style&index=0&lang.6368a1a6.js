var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,r=(e,t)=>{for(var l in t||(t={}))n.call(t,l)&&c(e,l,t[l]);if(a)for(var l of a(t))s.call(t,l)&&c(e,l,t[l]);return e},o=(e,a)=>t(e,l(a)),i=(e,t,l)=>new Promise(((a,n)=>{var s=e=>{try{r(l.next(e))}catch(t){n(t)}},c=e=>{try{r(l.throw(e))}catch(t){n(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,c);r((l=l.apply(e,t)).next())}));import{ag as d,A as u,ay as y,az as h,al as p,j as f,S as k,B as v,D as K,_ as b,L as g,F as x,a5 as A,a9 as m,aa as S,J as L,x as C,aw as _,a8 as E,ap as N,K as T,u as I,q as B,O as M,r as w,t as j,bS as D,o as O,aj as P,Y as R,R as U,bQ as $,G as H,H as F,bT as Y,a1 as X,ao as q,bx as z}from"./vendor.517bedfb.js";import{ai as G,_ as J,aq as Q,p as V,e as W,aH as Z,c as ee,ah as te,v as le,aI as ae,S as ne,aJ as se,ar as ce,B as re}from"./index.a6fa69dd.js";import{u as oe}from"./useContextMenu.63aa4de5.js";const ie=({icon:e})=>e?G(e)?d(J,{icon:e,class:"mr-1"}):J:null;var de,ue;(ue=de||(de={}))[ue.SELECT_ALL=0]="SELECT_ALL",ue[ue.UN_SELECT_ALL=1]="UN_SELECT_ALL",ue[ue.EXPAND_ALL=2]="EXPAND_ALL",ue[ue.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",ue[ue.CHECK_STRICTLY=4]="CHECK_STRICTLY",ue[ue.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY";var ye=u({name:"BasicTreeHeader",components:{BasicTitle:Q,Icon:J,Dropdown:y,Menu:h,MenuItem:h.Item,MenuDivider:h.Divider,InputSearch:p.Search},props:{helpMessage:{type:[String,Array],default:""},title:V.string,toolbar:V.bool,checkable:V.bool,search:V.bool,checkAll:V.func,expandAll:V.func},emits:["strictly-change","search"],setup(e,{emit:t}){const{t:l}=W(),a=f((()=>{const{checkable:t}=e,a=[{label:l("component.tree.expandAll"),value:2},{label:l("component.tree.unExpandAll"),value:3,divider:t}];return t?[{label:l("component.tree.selectAll"),value:0},{label:l("component.tree.unSelectAll"),value:1,divider:t},...a,{label:l("component.tree.checkStrictly"),value:4},{label:l("component.tree.checkUnStrictly"),value:5}]:a}));const n=k((function(e){t("search",e)}),200);return{t:l,toolbarList:a,handleMenuClick:function(l){var a,n,s,c;const{key:r}=l;switch(r){case 0:null==(a=e.checkAll)||a.call(e,!0);break;case 1:null==(n=e.checkAll)||n.call(e,!1);break;case 2:null==(s=e.expandAll)||s.call(e,!0);break;case 3:null==(c=e.expandAll)||c.call(e,!1);break;case 4:t("strictly-change",!1);break;case 5:t("strictly-change",!0)}},handleSearch:function(e){n(e.target.value)}}}});const he=T();v("data-v-b65cf3f2");const pe={class:"flex px-2 py-1.5 items-center basic-tree-header"},fe={key:2,class:"flex flex-1 justify-end items-center cursor-pointer"},ke={key:0,class:"mr-1 w-2/3"};K();const ve=he(((e,t,l,a,n,s)=>{const c=b("BasicTitle"),r=b("InputSearch"),o=b("Icon"),i=b("MenuItem"),d=b("MenuDivider"),u=b("Menu"),y=b("Dropdown");return g(),x("div",pe,[e.$slots.headerTitle?A(e.$slots,"headerTitle",{key:0},void 0,!0):m("v-if",!0),!e.$slots.headerTitle&&e.title?(g(),x(c,{key:1,helpMessage:e.helpMessage},{default:he((()=>[S(L(e.title),1)])),_:1},8,["helpMessage"])):m("v-if",!0),e.search||e.toolbar?(g(),x("div",fe,[e.search?(g(),x("div",ke,[C(r,{placeholder:e.t("common.searchText"),size:"small",allowClear:"",onChange:e.handleSearch},null,8,["placeholder","onChange"])])):m("v-if",!0),e.toolbar?(g(),x(y,{key:1,onClick:t[1]||(t[1]=_((()=>{}),["prevent"]))},{overlay:he((()=>[C(u,{onClick:e.handleMenuClick},{default:he((()=>[(g(!0),x(E,null,N(e.toolbarList,(e=>(g(),x(E,{key:e.value},[C(i,{key:e.value},{default:he((()=>[S(L(e.label),1)])),_:2},1040),e.divider?(g(),x(d,{key:0})):m("v-if",!0)],64)))),128))])),_:1},8,["onClick"])])),default:he((()=>[C(o,{icon:"ion:ellipsis-vertical"})])),_:1})):m("v-if",!0)])):m("v-if",!0)])}));ye.render=ve,ye.__scopeId="data-v-b65cf3f2";var Ke=u({name:"BasicTree",inheritAttrs:!1,props:{value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:V.string,toolbar:V.bool,search:V.bool,checkStrictly:V.bool,clickRowToExpand:V.bool.def(!0),checkable:V.bool.def(!1),defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:V.bool.def(!1),replaceFields:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:null},rightMenuList:{type:Array}},emits:["update:expandedKeys","update:selectedKeys","update:value","change","check"],setup(e,{attrs:t,slots:l,emit:a,expose:n}){const s=M({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),c=M({startSearch:!1,searchData:[]}),d=w([]),[u]=oe(),{prefixCls:y}=ee("basic-tree"),h=f((()=>{const{replaceFields:t}=e;return r({children:"children",title:"title",key:"key"},t)})),p=f((()=>{let l=o(r(r({blockNode:!0},t),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,replaceFields:I(h),"onUpdate:expandedKeys":e=>{s.expandedKeys=e,a("update:expandedKeys",e)},"onUpdate:selectedKeys":e=>{s.selectedKeys=e,a("update:selectedKeys",e)},onCheck:(e,t)=>{let l=j(s.checkedKeys);if(te(l)&&c.startSearch){const{key:e}=I(h);l=D(l,S(t.node.$attrs.node[e])),t.checked&&l.push(t.node.$attrs.node[e]),s.checkedKeys=l}else s.checkedKeys=e;const n=j(s.checkedKeys);a("update:value",n),a("check",n,t)},onRightClick:_});return O(l,"treeData","class")})),k=f((()=>c.startSearch?c.searchData:I(d))),v=f((()=>!k.value||0===k.value.length)),{deleteNodeByKey:K,insertNodeByKey:b,insertNodesByKey:g,filterByLevel:x,updateNodeByKey:A,getAllKeys:m,getChildrenKeys:S,getEnabledKeys:L}=function(e,t){function l(a){const n=[],s=a||I(e),{key:c,children:r}=I(t);if(!r||!c)return n;for(let e=0;e<s.length;e++){const t=s[e];n.push(t[c]);const a=t[r];a&&a.length&&n.push(...l(a))}return n}return{deleteNodeByKey:function l(a,n){if(!a)return;const s=n||I(e),{key:c,children:r}=I(t);if(r&&c)for(let e=0;e<s.length;e++){const t=s[e],n=t[r];if(t[c]===a){s.splice(e,1);break}n&&n.length&&l(a,t[r])}},insertNodeByKey:function({parentKey:l=null,node:a,push:n="push"}){const s=B(I(e));if(!l)return s[n](a),void(e.value=s);const{key:c,children:r}=I(t);r&&c&&(Z(s,(e=>{if(e[c]===l)return e[r]=e[r]||[],e[r][n](a),!0})),e.value=s)},insertNodesByKey:function({parentKey:l=null,list:a,push:n="push"}){const s=B(I(e));if(a&&!(a.length<1))if(l){const{key:c,children:r}=I(t);if(!r||!c)return;Z(s,(t=>{if(t[c]===l){t[r]=t[r]||[];for(let e=0;e<a.length;e++)t[r][n](a[e]);return e.value=s,!0}}))}else for(let e=0;e<a.length;e++)s[n](a[e])},filterByLevel:function l(a=1,n,s=1){if(!a)return[];const c=[],r=n||I(e)||[];for(let e=0;e<r.length;e++){const n=r[e],{key:o,children:i}=I(t),d=o?n[o]:"",u=i?n[i]:[];c.push(d),u&&u.length&&s<a&&(s+=1,c.push(...l(a,u,s)))}return c},updateNodeByKey:function l(a,n,s){if(!a)return;const c=s||I(e),{key:o,children:i}=I(t);if(i&&o)for(let e=0;e<c.length;e++){const t=c[e],s=t[i];if(t[o]===a){c[e]=r(r({},c[e]),n);break}s&&s.length&&l(a,n,t[i])}},getAllKeys:l,getChildrenKeys:function a(n,s){const c=[],r=s||I(e),{key:o,children:i}=I(t);if(!i||!o)return c;for(let e=0;e<r.length;e++){const t=r[e],s=t[i];n===t[o]?(c.push(t[o]),s&&s.length&&c.push(...l(s))):s&&s.length&&c.push(...a(n,s))}return c},getEnabledKeys:function l(a){const n=[],s=a||I(e),{key:c,children:r}=I(t);if(!r||!c)return n;for(let e=0;e<s.length;e++){const t=s[e];!0!==t.disabled&&!1!==t.selectable&&n.push(t[c]);const a=t[r];a&&a.length&&n.push(...l(a))}return n}}}(d,h);function _(t){return i(this,arguments,(function*({event:t,node:l}){var a;const{rightMenuList:n=[],beforeRightClick:s}=e;let c={event:t,items:[]};if(s&&le(s)){let e=yield s(l,t);Array.isArray(e)?c.items=e:Object.assign(c,e)}else c.items=n;(null==(a=c.items)?void 0:a.length)&&u(c)}))}function N(e){s.expandedKeys=e}function T(e){s.checkedKeys=e?L():[]}function G(e){s.expandedKeys=e?m():[]}function J(e){s.checkStrictly=e}function Q(e){if(!e)return void(c.startSearch=!1);c.startSearch=!0;const{title:t}=I(h);c.searchData=se(I(d),(l=>{var a,n;return null!=(n=null==(a=l[t])?void 0:a.includes(e))&&n}),I(h))}function V(t,l){if(e.clickRowToExpand&&l&&0!==l.length)if(s.expandedKeys.includes(t)){const e=[...s.expandedKeys],l=e.findIndex((e=>e===t));-1!==l&&e.splice(l,1),N(e)}else N([...s.expandedKeys,t])}P((()=>{d.value=e.treeData})),R((()=>{const t=parseInt(e.defaultExpandLevel);t>0?s.expandedKeys=x(t):e.defaultExpandAll&&G(!0)})),P((()=>{s.expandedKeys=e.expandedKeys})),P((()=>{s.selectedKeys=e.selectedKeys})),P((()=>{s.checkedKeys=e.checkedKeys})),U((()=>e.value),(()=>{s.checkedKeys=j(e.value||[])})),U((()=>s.checkedKeys),(()=>{const e=j(s.checkedKeys);a("update:value",e),a("change",e)})),P((()=>{s.checkStrictly=e.checkStrictly}));function W(t){const{actionList:l}=e;if(l&&0!==l.length)return l.map(((e,l)=>{var a;let n=!0;return le(e.show)?n=null==(a=e.show)?void 0:a.call(e,t):re(e.show)&&(n=e.show),n?C("span",{key:l,class:`${y}__action`},[e.render(t)]):null}))}function de({data:t,level:a}){return t?t.map((t=>{const{title:n,key:s,children:c}=I(h),i=O(t,"title"),d=function(t,l){return!l&&e.renderIcon&&le(e.renderIcon)?e.renderIcon(t):l}(o(r({},t),{level:a}),t.icon),u=z(t,c)||[];return C(Y.TreeNode,X(i,{node:j(t),key:z(t,s)}),{title:()=>{var e;return C("span",{class:`${y}-title pl-2`,onClick:V.bind(null,t[s],t[c])},[(null==l?void 0:l.title)?ce(l,"title",t):C(E,null,[d&&C(ie,{icon:d},null),C("span",{class:(null==(e=I(p))?void 0:e.blockNode)?`${y}__content`:""},[z(t,n)]),C("span",{class:`${y}__actions`},[W(o(r({},t),{level:a}))])])])},default:()=>de({data:u,level:a+1})})})):null}return n({setExpandedKeys:N,getExpandedKeys:function(){return s.expandedKeys},setSelectedKeys:function(e){s.selectedKeys=e},getSelectedKeys:function(){return s.selectedKeys},setCheckedKeys:function(e){s.checkedKeys=e},getCheckedKeys:function(){return s.checkedKeys},insertNodeByKey:b,insertNodesByKey:g,deleteNodeByKey:K,updateNodeByKey:A,checkAll:T,expandAll:G,filterByLevel:e=>{s.expandedKeys=x(e)}}),()=>{let a;const{title:n,helpMessage:s,toolbar:c,search:o,checkable:i}=e,d=n||c||o||l.headerTitle;return C("div",{class:[y,"h-full",t.class]},[d&&C(ye,{checkable:i,checkAll:T,expandAll:G,title:n,search:o,toolbar:c,helpMessage:s,onStrictlyChange:J,onSearch:Q},(u=a=ae(l),"function"==typeof u||"[object Object]"===Object.prototype.toString.call(u)&&!$(u)?a:{default:()=>[a]})),H(C(ne,{style:{height:"calc(100% - 38px)"}},{default:()=>[C(Y,X(I(p),{showIcon:!1}),r({default:()=>de({data:I(k),level:1})},ae(l)))]}),[[F,!I(v)]]),H(C(q,{image:q.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[F,I(v)]])]);var u}}});export{Ke as _};
