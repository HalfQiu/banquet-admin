var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l;import{A as a,r as i,j as c,Y as u,Z as d,af as p,u as m,x as f,az as y,a8 as b,bs as v,bf as h,aL as x,ae as j}from"./vendor.8887d027.js";import{_ as O,aZ as w}from"./index.139ebaf4.js";/* empty css              */const E={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}},L=e=>{const{item:t}=e;return f("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&f(O,{class:"mr-2",icon:t.icon},null),f("span",null,[t.label])])};var g=a({name:"ContextMenu",props:E,setup(e){const a=i(null),x=i(!1),j=c((()=>{const{axis:a,items:i,styles:c,width:u}=e,{x:d,y:p}=a||{x:0,y:0},m=40*(i||[]).length,f=u,y=document.body,b=y.clientWidth<d+f?d-f:d,v=y.clientHeight<p+m?p-m:p;return h=((e,t)=>{for(var n in t||(t={}))s.call(t,n)&&r(e,n,t[n]);if(l)for(var n of l(t))o.call(t,n)&&r(e,n,t[n]);return e})({},c),t(h,n({width:`${u}px`,left:`${b+1}px`,top:`${v+1}px`}));var h}));function O(e,t){const{handler:n,disabled:l}=e;l||(x.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function w(t){return t.map((t=>{const{disabled:n,label:l,children:s,divider:o=!1}=t,r={item:t,handler:O,showIcon:e.showIcon};return s&&0!==s.length?m(x)?f(y.SubMenu,{key:l,disabled:n,popupClassName:"context-menu__popup"},{title:()=>f(L,r,null),default:()=>w(s)}):null:f(b,null,[f(y.Item,{disabled:n,class:"context-menu__item",key:l},{default:()=>[f(L,r,null)]}),o?f(v,{key:`d-${l}`},null):null])}))}return u((()=>{d((()=>x.value=!0))})),p((()=>{const e=m(a);e&&document.body.removeChild(e)})),()=>{let t;if(!m(x))return null;const{items:n}=e;return f(y,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:a,style:m(j)},"function"==typeof(l=t=w(n))||"[object Object]"===Object.prototype.toString.call(l)&&!h(l)?t:{default:()=>[t]});var l}}});const k={domList:[],resolve:()=>{}},I=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),w)return new Promise((n=>{const l=document.body,s=document.createElement("div"),o={};e.styles&&(o.styles=e.styles),e.items&&(o.items=e.items),e.event&&(o.customEvent=t,o.axis={x:t.clientX,y:t.clientY});const r=f(g,o);x(r,s);const a=function(){k.resolve("")};k.domList.push(s);const i=function(){k.domList.forEach((e=>{try{e&&l.removeChild(e)}catch(t){}})),l.removeEventListener("click",a),l.removeEventListener("scroll",a)};k.resolve=function(e){i(),n(e)},i(),l.appendChild(s),l.addEventListener("click",a),l.addEventListener("scroll",a)}))},P=function(){k&&(k.resolve(""),k.domList=[])};function C(e=!0){return j()&&e&&p((()=>{P()})),[I,P]}export{C as u};
